<nav class="navbar navbar-expand-lg navbar-dark bg-dark px-3">
  <a class="navbar-brand" routerLink="/">Lautaro Diesel</a>

  <button
    class="navbar-toggler"
    type="button"
    data-bs-toggle="collapse"
    data-bs-target="#navbarNav"
  >
    <span class="navbar-toggler-icon"></span>
  </button>

  <div class="collapse navbar-collapse" id="navbarNav">
    <!-- Left side links -->
    <ul class="navbar-nav">
      <li class="nav-item">
        <a class="nav-link" routerLink="/productos" routerLinkActive="active">Productos</a>
      </li>

      <li class="nav-item">
        <a class="nav-link" routerLink="/terminos" routerLinkActive="active">T茅rminos y Condiciones</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" routerLink="/faq" routerLinkActive="active">Preguntas Frecuentes</a>
      </li>
    </ul>

    <!-- Right side: cart + authentication controls -->
    <ul class="navbar-nav ms-auto align-items-lg-center">
      <!-- Carrito a la derecha con icono -->
      <li class="nav-item ms-lg-auto me-lg-2">
  <a class="nav-link d-flex align-items-center gap-2" routerLink="/carrito">
     Carrito
    <span class="badge bg-primary">{{ (totalCount$ | async) || 0 }}</span>
  </a>
</li>


      <li class="nav-item" *ngIf="!isAuthenticated()">
        <a class="nav-link" routerLink="/register" routerLinkActive="active">Registrarse</a>
      </li>
      <li class="nav-item" *ngIf="!isAuthenticated()">
        <a class="nav-link" routerLink="/login" routerLinkActive="active">Iniciar sesi贸n</a>
      </li>

      <li class="nav-item" *ngIf="isAuthenticated()">
        <a class="nav-link" routerLink="/profile" routerLinkActive="active">Ver perfil</a>
      </li>
      <li class="nav-item" *ngIf="isAdmin()">
        <a class="nav-link" routerLink="/admin" routerLinkActive="active">Panel</a>
      </li>
      <li class="nav-item" *ngIf="isAuthenticated()">
        <a
          class="nav-link"
          href="#"
          role="button"
          (click)="openLogoutConfirm(); $event.preventDefault()"
        >Cerrar sesi贸n</a>
      </li>
    </ul>
  </div>
</nav>

<!-- Logout confirmation modal -->
@if (showLogoutConfirm) {
<div class="navbar-modal-backdrop" (click)="cancelLogout()">
  <div class="navbar-modal-dialog" role="dialog" (click)="$event.stopPropagation()">
    <div class="navbar-modal-content p-3">
      <h5 class="mb-2">驴Est谩s seguro que quieres cerrar sesi贸n?</h5>
      <p class="small text-muted">
        Se cerrar谩 tu sesi贸n actual y volver谩s a la pantalla de inicio de sesi贸n.
      </p>
      <div class="text-end">
        <button class="btn btn-outline-secondary me-2" (click)="cancelLogout()">Cancelar</button>
        <button class="btn btn-danger" (click)="confirmLogout()">Cerrar sesi贸n</button>
      </div>
    </div>
  </div>
</div>
}

<style>
  .navbar-modal-backdrop {
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.6) !important;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 2050 !important;
  }
  .navbar-modal-dialog {
    max-width: 420px;
    width: 100%;
    padding: 12px;
  }
  .navbar-modal-content {
    background: #fff;
    border-radius: 0.375rem;
    box-shadow: 0 6px 18px rgba(0, 0, 0, 0.2);
  }
</style>
