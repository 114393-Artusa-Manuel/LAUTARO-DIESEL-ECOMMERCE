<div class="container py-4">
  <div class="row justify-content-center">
    <div class="col-12 col-md-8 col-lg-6">
      <div class="card shadow-sm">
        <div class="card-body p-4">
          <h3 class="card-title mb-3 text-center">Crear cuenta</h3>

          <div *ngIf="backendDown" class="alert alert-danger" role="alert">
            No se pudo conectar con el servidor. Verificá que el backend esté encendido en
            <strong>http://localhost:8080</strong>
          </div>

          <form [formGroup]="f" (ngSubmit)="submit()" novalidate>
            <div class="mb-3">
              <label for="correo" class="form-label">Correo</label>
              <input id="correo" class="form-control" formControlName="correo" type="email" placeholder="tu@correo.com" maxlength="254" required />
              <div *ngIf="f.controls.correo.touched || f.controls.correo.dirty" class="invalid-feedback d-block">
                <div *ngIf="f.controls.correo.hasError('required')">El correo es obligatorio.</div>
                <div *ngIf="f.controls.correo.hasError('email')">Ingresá un correo válido (ej: ejemplo@gmail.com).</div>
                <div *ngIf="f.controls.correo.hasError('maxlength')">Máximo 254 caracteres.</div>
              </div>
            </div>

            <div class="mb-3">
              <label for="clave" class="form-label">Contraseña</label>
              <input id="clave" class="form-control" formControlName="clave" type="password" minlength="4" maxlength="128" placeholder="mínimo 4 caracteres" required />
              <div *ngIf="f.controls.clave.touched || f.controls.clave.dirty" class="invalid-feedback d-block">
                <div *ngIf="f.controls.clave.hasError('required')">La contraseña es obligatoria.</div>
                <div *ngIf="f.controls.clave.hasError('minlength')">Mínimo 4 caracteres.</div>
                <div *ngIf="f.controls.clave.hasError('maxlength')">Máximo 128 caracteres.</div>
              </div>
            </div>

            <div class="mb-3">
              <label for="nombreCompleto" class="form-label">Nombre completo</label>
              <input id="nombreCompleto" class="form-control" formControlName="nombreCompleto" maxlength="120" required />
              <div *ngIf="f.controls.nombreCompleto.touched || f.controls.nombreCompleto.dirty" class="invalid-feedback d-block">
                <div *ngIf="f.controls.nombreCompleto.hasError('required')">El nombre es obligatorio.</div>
                <div *ngIf="f.controls.nombreCompleto.hasError('maxlength')">Máximo 120 caracteres.</div>
              </div>
            </div>

            <div class="mb-3">
              <label for="telefono" class="form-label">Teléfono (opcional)</label>
              <input id="telefono" class="form-control" formControlName="telefono" maxlength="20" placeholder="(xxx) xxx-xxxx" />
              <div *ngIf="f.controls.telefono.touched || f.controls.telefono.dirty" class="invalid-feedback d-block">
                <div *ngIf="f.controls.telefono.hasError('maxlength')">Máximo 20 caracteres.</div>
              </div>
            </div>

            <div class="d-grid gap-2">
              <button class="btn btn-primary" type="submit" [disabled]="loading">
                <span *ngIf="!loading">Registrarme</span>
                <span *ngIf="loading">Registrando...</span>
              </button>
            </div>
          </form>

          <div class="mt-3 text-center">
            <a routerLink="/login">¿Ya tenés cuenta? Iniciar sesión</a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Success modal (simple) -->
  <div class="modal-backdrop" *ngIf="showSuccess" (click)="closeSuccess()">
    <div class="modal-dialog" role="dialog" (click)="$event.stopPropagation()">
      <div class="modal-content p-3 text-center">
        <h5>¡Registro exitoso!</h5>
        <p>Se creó tu usuario correctamente. Redirigiendo a inicio de sesión...</p>
        <div class="mt-2">
          <button class="btn btn-secondary me-2" (click)="closeSuccess()">Cerrar</button>
        </div>
      </div>
    </div>
  </div>
</div>
